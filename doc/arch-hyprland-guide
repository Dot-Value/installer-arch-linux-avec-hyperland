# Guide d'installation Arch Linux + Hyprland

## 1. Préparation avant l'installation

### Vérifier le mode de démarrage (UEFI ou BIOS)
```bash
ls /sys/firmware/efi/efivars
```
**Explication :** Si ce dossier existe, vous êtes en mode UEFI. Sinon, vous êtes en mode BIOS legacy.

### Connexion à Internet

**Pour Wi-Fi :**
```bash
iwctl
station wlan0 scan
station wlan0 get-networks
station wlan0 connect "NomDuRéseau"
exit
```
**Explication :** `iwctl` est l'outil de gestion Wi-Fi. Remplacez "NomDuRéseau" par votre SSID.

**Vérifier la connexion :**
```bash
ping -c 3 archlinux.org
```

### Synchroniser l'horloge système
```bash
timedatectl set-ntp true
```
**Explication :** Active la synchronisation automatique de l'heure via NTP.

## 2. Partitionnement du disque

### Lister les disques disponibles
```bash
lsblk
```
**Explication :** Identifiez votre disque cible (généralement `/dev/sda` ou `/dev/nvme0n1`).

### Créer les partitions avec cfdisk
```bash
cfdisk /dev/sda
```
**Explication :** Remplacez `/dev/sda` par votre disque. Créez les partitions suivantes :

**Schéma recommandé pour UEFI :**
- `/dev/sda1` : 512M (Type: EFI System) → Partition EFI
- `/dev/sda2` : 4G (Type: Linux swap) → Swap
- `/dev/sda3` : Reste (Type: Linux filesystem) → Racine

### Formater les partitions

**Partition EFI :**
```bash
mkfs.fat -F32 /dev/sda1
```

**Partition Swap :**
```bash
mkswap /dev/sda2
swapon /dev/sda2
```

**Partition racine :**
```bash
mkfs.ext4 /dev/sda3
```
**Explication :** On formate en FAT32 pour l'EFI, on active le swap, et on utilise ext4 pour la racine.

### Monter les partitions
```bash
mount /dev/sda3 /mnt
mkdir -p /mnt/boot
mount /dev/sda1 /mnt/boot
```
**Explication :** Monte la partition racine et crée le point de montage pour l'EFI.

## 3. Installation du système de base

### Installer les paquets essentiels
```bash
pacstrap /mnt base linux linux-firmware base-devel vim nano git networkmanager
```
**Explication :** Installe le noyau Linux, les outils de base et les utilitaires réseau.

### Générer le fichier fstab
```bash
genfstab -U /mnt >> /mnt/etc/fstab
```
**Explication :** Crée la configuration des points de montage automatiques au démarrage.

### Entrer dans le système installé
```bash
arch-chroot /mnt
```

## 4. Configuration du système

### Configurer le fuseau horaire
```bash
ln -sf /usr/share/zoneinfo/Europe/Paris /etc/localtime
hwclock --systohc
```
**Explication :** Définit le fuseau horaire (ajustez selon votre localisation) et synchronise l'horloge matérielle.

### Configurer la locale
```bash
nano /etc/locale.gen
```
Décommentez `fr_FR.UTF-8 UTF-8` et `en_US.UTF-8 UTF-8`, puis :
```bash
locale-gen
echo "LANG=fr_FR.UTF-8" > /etc/locale.conf
```

### Configurer le clavier
```bash
echo "KEYMAP=fr" > /etc/vconsole.conf
```
**Explication :** Définit le clavier français. Utilisez `us` pour QWERTY américain.

### Configurer le nom d'hôte
```bash
echo "monpc" > /etc/hostname
```
Remplacez "monpc" par le nom souhaité.

### Configurer le fichier hosts
```bash
nano /etc/hosts
```
Ajoutez :
```
127.0.0.1   localhost
::1         localhost
127.0.1.1   monpc.localdomain monpc
```

### Définir le mot de passe root
```bash
passwd
```

### Créer un utilisateur
```bash
useradd -m -G wheel,audio,video,storage -s /bin/bash votrenom
passwd votrenom
```
**Explication :** Crée un utilisateur avec les groupes nécessaires et définit son mot de passe.

### Activer sudo pour le groupe wheel
```bash
EDITOR=nano visudo
```
Décommentez la ligne :
```
%wheel ALL=(ALL:ALL) ALL
```

## 5. Installation du bootloader

### Installer GRUB et efibootmgr
```bash
pacman -S grub efibootmgr
```

### Installer GRUB
```bash
grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=GRUB
```

### Générer la configuration GRUB
```bash
grub-mkconfig -o /boot/grub/grub.cfg
```

### Activer NetworkManager
```bash
systemctl enable NetworkManager
```

## 6. Finaliser l'installation de base

### Sortir du chroot et redémarrer
```bash
exit
umount -R /mnt
reboot
```

## 7. Installation de Hyprland (après redémarrage)

### Se connecter avec votre utilisateur

### Installer un helper AUR (yay)
```bash
cd /tmp
git clone https://aur.archlinux.org/yay.git
cd yay
makepkg -si
```
**Explication :** `yay` facilite l'installation de paquets depuis AUR.

### Installer Hyprland et dépendances
```bash
sudo pacman -S hyprland waybar kitty wofi dunst polkit-kde-agent qt5-wayland qt6-wayland xdg-desktop-portal-hyprland
```
**Explication :** 
- `hyprland` : Le compositeur Wayland
- `waybar` : Barre d'état
- `kitty` : Émulateur de terminal
- `wofi` : Lanceur d'applications
- `dunst` : Gestionnaire de notifications
- `polkit-kde-agent` : Authentification graphique

### Installer des polices
```bash
sudo pacman -S ttf-font-awesome ttf-jetbrains-mono-nerd
```

### Créer la configuration Hyprland
```bash
mkdir -p ~/.config/hypr
cp /usr/share/hyprland/hyprland.conf ~/.config/hypr/
```

### Éditer la configuration (optionnel)
```bash
nano ~/.config/hypr/hyprland.conf
```

Ajoutez ces lignes utiles :
```
# Touches de base
$mod = SUPER

# Lancer le terminal
bind = $mod, RETURN, exec, kitty

# Lancer le lanceur
bind = $mod, D, exec, wofi --show drun

# Fermer la fenêtre
bind = $mod SHIFT, Q, killactive

# Quitter Hyprland
bind = $mod SHIFT, E, exit

# Naviguer entre les fenêtres
bind = $mod, left, movefocus, l
bind = $mod, right, movefocus, r
bind = $mod, up, movefocus, u
bind = $mod, down, movefocus, d
```

## 8. Lancer Hyprland

### Depuis le TTY
```bash
Hyprland
```

### OU installer un display manager (optionnel)
```bash
sudo pacman -S sddm
sudo systemctl enable sddm
```
**Explication :** SDDM offre un écran de connexion graphique au démarrage.

## 9. Configurations supplémentaires recommandées

### Installer un navigateur
```bash
sudo pacman -S firefox
```

### Installer un gestionnaire de fichiers
```bash
sudo pacman -S thunar
```

### Installer des outils système utiles
```bash
sudo pacman -S htop neofetch grim slurp wl-clipboard
```
**Explication :** 
- `grim` + `slurp` : Captures d'écran sous Wayland
- `wl-clipboard` : Presse-papier pour Wayland

### Configurer Waybar
```bash
mkdir -p ~/.config/waybar
cp /etc/xdg/waybar/config ~/.config/waybar/
cp /etc/xdg/waybar/style.css ~/.config/waybar/
```

## Touches utiles par défaut dans Hyprland

- `SUPER + Q` : Fermer la fenêtre active
- `SUPER + M` : Quitter Hyprland
- `SUPER + E` : Ouvrir le gestionnaire de fichiers
- `SUPER + V` : Basculer le mode flottant
- `SUPER + [1-9]` : Changer d'espace de travail
- `SUPER + Clic gauche` : Déplacer une fenêtre
- `SUPER + Clic droit` : Redimensionner une fenêtre

---

## Dépannage

**Si le Wi-Fi ne fonctionne pas après redémarrage :**
```bash
sudo systemctl start NetworkManager
nmtui
```

**Si Hyprland ne démarre pas :**
Vérifiez les logs :
```bash
cat ~/.local/share/hyprland/hyprland.log
```

**Pour mettre à jour le système :**
```bash
sudo pacman -Syu
```

---

**Félicitations !** Vous avez maintenant Arch Linux avec Hyprland installé. N'hésitez pas à personnaliser votre configuration dans `~/.config/hypr/hyprland.conf` !
